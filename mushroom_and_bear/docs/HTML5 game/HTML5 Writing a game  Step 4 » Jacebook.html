<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0066)http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/ -->
<html dir="ltr" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>HTML5 Writing a game: Step 4 » Jacebook</title>
<link rel="shortcut icon" type="image/ico" href="http://jacebook.co.uk/wp-content/themes/redbel/favicon.ico">
<link href="./HTML5 Writing a game  Step 4 » Jacebook_files/style.css" rel="stylesheet" type="text/css" media="all">
<link rel="pingback" href="http://jacebook.co.uk/xmlrpc.php">
<script type="text/javascript" src="./HTML5 Writing a game  Step 4 » Jacebook_files/jquery.min.js"></script>
<!--[if lte IE 8]> 
<style type="text/css">/* Styles globaux */
#comments li, #comments input.text, #comments textarea, #comments .input-text {behavior:url(http://jacebook.co.uk/wp-content/themes/redbel/js/border-radius.htc);}
{behavior:url(http://jacebook.co.uk/wp-content/themes/redbel/js/border-radius.htc);}
</style>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="Jacebook » Feed" href="http://jacebook.co.uk/feed/">
<link rel="alternate" type="application/rss+xml" title="Jacebook » Comments Feed" href="http://jacebook.co.uk/comments/feed/">
<script type="text/javascript" src="./HTML5 Writing a game  Step 4 » Jacebook_files/l10n.js"></script>
<script type="text/javascript" src="./HTML5 Writing a game  Step 4 » Jacebook_files/comment-reply.js"></script>
<link rel="prev" title="HTML5 Writing a game: Step 3" href="http://jacebook.co.uk/blog/2010/09/12/html5-writing-a-game-step-3/">
<link rel="next" title="HTML5 Writing a game: Step 5" href="http://jacebook.co.uk/blog/2010/09/20/html5-writing-a-game-step-5/">
<link rel="canonical" href="./HTML5 Writing a game  Step 4 » Jacebook_files/HTML5 Writing a game  Step 4 » Jacebook.html">
<link rel="shortlink" href="http://jacebook.co.uk/?p=202">
<link rel="stylesheet" type="text/css" href="./HTML5 Writing a game  Step 4 » Jacebook_files/social_widget.css">
<style type="text/css">
#header{
    background: url(http://jacebook.co.uk/wp-content/themes/redbel/empty-header.png) no-repeat;
    height: 153px;
    width:1000px;
}
#header h1.blog-title a, #site-description {
    color:#fff;
}
</style>
<link rel="stylesheet" type="text/css" href="./HTML5 Writing a game  Step 4 » Jacebook_files/shCore.css"><link rel="stylesheet" type="text/css" href="./HTML5 Writing a game  Step 4 » Jacebook_files/shThemeDefault.css"><meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3">


</head>
<body class="single single-post postid-202 single-format-standard">
<div class="website-container">
	<div id="header">
		<form action="http://jacebook.co.uk/">
			<div class="search-form">
				<label class="search-label-sliding" for="search-sliding" style="left: 15px; opacity: 0.4; ">Search</label>
				<input name="s" id="search-sliding" class="search-sliding" type="text" value="">
				<input type="image" name="Search" src="./HTML5 Writing a game  Step 4 » Jacebook_files/transparent.gif" alt="Search" class="search-button">
			</div>
		</form>
		<h1 class="blog-title"><a href="http://jacebook.co.uk/">Jacebook</a></h1>
		<div id="site-description">The ramblings of Jason Croucher</div>
		<a href="http://jacebook.co.uk/feed/"><img src="./HTML5 Writing a game  Step 4 » Jacebook_files/transparent.gif" height="33" width="55" alt="RSS Feed" id="rss-button"></a>
	<div class="menu"><ul><li style="background-position: 0px 38px; "><a href="http://jacebook.co.uk/" title="Home">Home</a></li><li class="page_item page-item-12 current_page_parent"><a href="http://jacebook.co.uk/news/" title="News">News</a></li><li class="page_item page-item-2" style="background-position: 0px 38px; "><a href="http://jacebook.co.uk/about/" title="About">About</a></li></ul></div>
	</div>	<div id="content">
				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="http://jacebook.co.uk/blog/2010/09/12/html5-writing-a-game-step-3/" rel="prev"><span class="meta-nav">←</span> HTML5 Writing a game: Step 3</a></div>
					<div class="nav-next"><a href="http://jacebook.co.uk/blog/2010/09/20/html5-writing-a-game-step-5/" rel="next">HTML5 Writing a game: Step 5 <span class="meta-nav">→</span></a></div>
				</div><!-- #nav-above -->

		<div id="post-202" class="post-202 post type-post status-publish format-standard hentry category-html5 category-java-script category-jquery tag-bouncing-animals tag-game tag-html5 tag-iphone article">
			<div class="article-corps-title">
				<div class="article-top"><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#header" class="top-link" style="background-position: 100% 0%; ">TOP</a></div>
				<h2 class="article-title"><a href="./HTML5 Writing a game  Step 4 » Jacebook_files/HTML5 Writing a game  Step 4 » Jacebook.html" title="Permalink to HTML5 Writing a game: Step 4" rel="bookmark">HTML5 Writing a game: Step 4</a></h2>
				<div class="article-date"><span class="month">Sep</span> <span class="day">15</span></div>
				<div class="article-meta-autor">Posted by Jason Croucher in <a href="http://jacebook.co.uk/blog/category/html5/" title="View all posts in html5" rel="category tag">html5</a>, <a href="http://jacebook.co.uk/blog/category/java-script/" title="View all posts in Java Script" rel="category tag">Java Script</a>, <a href="http://jacebook.co.uk/blog/category/java-script/jquery/" title="View all posts in jQuery" rel="category tag">jQuery</a></div>
			</div>
			<div class="article-corps">
				<div class="article-page-contents">
				<h3>Collision detection, prizes and the small matter of a complete re-write!</h3>
<p>If you’re keen to see how far things have got and have a play, there’s a link at the bottom of this post.</p>
<p>So, considering the next step in my research, I wanted to add the prizes for the animal to bounce up and win! I have to be honest at this point, I’m not a javascript developer (I come more from a java background and C in days gone by). So I reviewed my Objective C code for the iPhone game and quickly realised that I needed to re-think my javascript code and consider the prospect of some sort of OO design (if that was indeed possible in javascript). So, using <a href="http://www.google.co.uk/search?sourceid=chrome&ie=UTF-8&q=object+oriented+design+javascript">Google</a> I quickly had a wealth of material about creating Objects in javascript. This isn’t a tutorial on javascript and I’m sure any of you who are javascript experts could write my game a lot better. In fact this isn’t a tutorial on any language or framework, it’s simply a blog of my findings when re-writing the iPhone game for the web using HTML5. However, for those that don’t know javascript well, I would encourage you to consider reading/watching these links:-</p>
<p><a href="http://articles.sitepoint.com/article/oriented-programming-1">http://articles.sitepoint.com/article/oriented-programming-1</a></p>
<p><a href="http://articles.sitepoint.com/article/oriented-programming-2">http://articles.sitepoint.com/article/oriented-programming-2</a></p>
<p><a href="http://www.youtube.com/watch?v=GKfHdOrR3lw">http://www.youtube.com/watch?v=GKfHdOrR3lw</a></p>
<p>So, moving swiftly on, let’s see what I have so far for the web version of <a href="http://bouncinganimals.blogspot.com/">Bouncing Animals</a></p>
<h4>The basic concept of a GameObject</h4>
<p>All the pieces of the game, i.e. the animal, mushroom, prizes etc. can be considered game objects and they each share a number of properties. Namely, their x,y co-ordinates on the canvas and an image that represents the object.</p>
<p>So here is our javascript definition of each object in the game.</p>
<div><div id="highlighter_7668" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">//base definition of a game object</code></div><div class="line number2 index1 alt1"><code class="plain plain">function GameObject()</code></div><div class="line number3 index2 alt2"><code class="plain plain">{</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">this.x = 0;</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">this.y = 0;</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">this.image = null;</code></div><div class="line number7 index6 alt2"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Next I defined each object that extends the basic GameObject defined above.</p>
<h4>The Animal</h4>
<p><img src="./HTML5 Writing a game  Step 4 » Jacebook_files/bear_eyesopen.png" alt="Bear!"><br>
The star of the game is of course the animal bouncing (on a mushroom) to reach the food up high. In the complete game there are a few animals but we’ll focus on the bear here for the first level. However, the only thing that really separates each animal is the image that represents it, so all animals can be considered as shown below.</p>
<div><div id="highlighter_446616" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">//Declare and extend GameObject for Animal</code></div><div class="line number2 index1 alt1"><code class="plain plain">function Animal() {};</code></div><div class="line number3 index2 alt2"><code class="plain plain">Animal.prototype = new GameObject();</code></div><div class="line number4 index3 alt1"><code class="plain plain">Animal.prototype.angle = 0;</code></div><div class="line number5 index4 alt2"><code class="plain plain">Animal.prototype.eyesOpenImage = null;</code></div></div></td></tr></tbody></table></div></div>
<p>Here we extend GameObject and add a couple of properties that are pertinent to the animal.<br>
1. The angle that the animal currently is (i.e. as the animal bounces around the screen it rotates)<br>
2. An alternative image for the animal with its eyes open</p>
<h4>The Mushroom</h4>
<p><img src="./HTML5 Writing a game  Step 4 » Jacebook_files/mushroom.png" alt="mushroom!"></p>
<div><div id="highlighter_710825" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">//Extend GameObject for Mushroom</code></div><div class="line number2 index1 alt1"><code class="plain plain">function Mushroom() {};</code></div><div class="line number3 index2 alt2"><code class="plain plain">Mushroom.prototype = new GameObject();</code></div><div class="line number4 index3 alt1"><code class="plain plain">Mushroom.prototype.boing = false;</code></div><div class="line number5 index4 alt2"><code class="plain plain">Mushroom.prototype.wobble = false;</code></div><div class="line number6 index5 alt1"><code class="plain plain">Mushroom.prototype.wobbleCount = 0;</code></div><div class="line number7 index6 alt2"><code class="plain plain">Mushroom.prototype.squashedImage = null;</code></div></div></td></tr></tbody></table></div></div>
<p>Again, I extended GameObject but added some properties that are pertinent to the mushroom.</p>
<p>1. A boing boolean to tell us if the mushroom is currently boinging!<br>
2. A wobble boolean to toggle and decide which image to show<br>
3. A wobble count to count the number of times the mushroom has wobbled<br>
4. An alternative image of the mushroom squashed.</p>
<h4>The Prize</h4>
<p><img src="./HTML5 Writing a game  Step 4 » Jacebook_files/leaf.png"><img src="./HTML5 Writing a game  Step 4 » Jacebook_files/acorn.png"><img src="./HTML5 Writing a game  Step 4 » Jacebook_files/flower.png"><br>
Prizes are food for the animals to catch as they bounce up. The prizes are arranged in rows and columns along the top the screen area.</p>
<div><div id="highlighter_387554" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">//Declare and extend GameObject for prize</code></div><div class="line number2 index1 alt1"><code class="plain plain">function Prize() {};</code></div><div class="line number3 index2 alt2"><code class="plain plain">Prize.prototype = new GameObject();</code></div><div class="line number4 index3 alt1"><code class="plain plain">Prize.prototype.row = 0;</code></div><div class="line number5 index4 alt2"><code class="plain plain">Prize.prototype.col = 0;</code></div><div class="line number6 index5 alt1"><code class="plain plain">Prize.prototype.hit = false;</code></div><div class="line number7 index6 alt2"><code class="plain plain">Prize.prototype.angle = 0;</code></div></div></td></tr></tbody></table></div></div>
<p>I declared the Prize as shown above. Again, this extends GameObject but also adds:</p>
<p>1. row – which is used to define which row the prize resides on.<br>
2. col – which is used to define which row the prize resides on.<br>
3. hit – whether it’s been hit by the animal.<br>
4. angle – its current angle. Why? Well because when the animal hits the prize it spins around before disappearing.</p>
<h4>Collision Detection</h4>
<p>Now I have introduce the concept of more than one thing the animal can hit, I needed to consider a generic collision detection routine for any objects in the game. </p>
<div><div id="highlighter_467969" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">01</div><div class="line number2 index1 alt1">02</div><div class="line number3 index2 alt2">03</div><div class="line number4 index3 alt1">04</div><div class="line number5 index4 alt2">05</div><div class="line number6 index5 alt1">06</div><div class="line number7 index6 alt2">07</div><div class="line number8 index7 alt1">08</div><div class="line number9 index8 alt2">09</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">//Check if 2 objects intersect</code></div><div class="line number2 index1 alt1"><code class="plain plain">function checkIntersect(object1, object2, overlap)</code></div><div class="line number3 index2 alt2"><code class="plain plain">{</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//&nbsp;&nbsp;&nbsp; x-Axis&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x-Axis</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//&nbsp; A1------&gt;B1 C1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A2------&gt;B2 C2</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//&nbsp; +--------+&nbsp;&nbsp; ^&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +--------+&nbsp;&nbsp; ^</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//&nbsp; | object1|&nbsp;&nbsp; | y-Axis&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | object2|&nbsp;&nbsp; | y-Axis</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; |</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//&nbsp; +--------+&nbsp; D1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +--------+&nbsp; D2</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">A1 = object1.x + overlap;</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">B1 = object1.x + object1.image.width - overlap;</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">C1 = object1.y + overlap;</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">D1 = object1.y + object1.image.height - overlap;</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">A2 = object2.x + overlap;</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">B2 = object2.x + object2.image.width - overlap;</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">C2 = object2.y + overlap;</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">D2 = object2.y + object2.image.width - overlap;</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Do they overlap on the x-Axis</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(A1 &gt; A2 &amp;&amp; A1 &lt; B2</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|| B1 &gt; A2 &amp;&amp; B1 &lt; B2)</code></div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//x axis intersects so check y axis</code></div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(C1 &gt; C2 &amp;&amp; C1 &lt; D1</code></div><div class="line number28 index27 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|| D1 &gt; C2 &amp;&amp; D1 &lt; D2)</code></div><div class="line number29 index28 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number30 index29 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//overlap</code></div><div class="line number31 index30 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return true;</code></div><div class="line number32 index31 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number35 index34 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//as you were</code></div><div class="line number36 index35 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">return false;</code></div><div class="line number37 index36 alt2"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Possibly not the most accurate intersect routine i.e. when the rectangle representing the animal is rotated it would be better to consider the “separating axis test” described in this document <a href="http://www.google.co.uk/url?sa=t&source=web&cd=1&ved=0CBgQFjAA&url=http%3A%2F%2Fwww.geometrictools.com%2FDocumentation%2FMethodOfSeparatingAxes.pdf&rct=j&q=The%20Method%20of%20Separating%20Axis&ei=aAyRTLKBMtKR4gaGqYHZDQ&usg=AFQjCNGU5Zd6k-BJvQo6jN0aYMZ73RZwyQ">The Method of Separating+Axis</a> and explained in this answer <a href="http://stackoverflow.com/questions/115426/algorithm-to-detect-intersection-of-two-rectangles">http://stackoverflow.com/questions/115426/algorithm-to-detect-intersection-of-two-rectangles</a>. However, what’s important here is we have a generic routine that expects 2 objects of type GameObject and returns true or false if the rectangles representing each object overlap. You’ll notice also there is an overlap parameter. This is to artificially reduce an objects size when performing the test and only return true when an overlap of the specified number of pixels exists. This is useful for the mushroom as we want the animal to slightly overlap the mushroom image before bouncing off and not as soon as it hits the bounding edges.</p>
<h4>Bounding Edges</h4>
<p>For the purposes of seeing what’s going on, I’ve included the following function which draws a red rectangle around the bounds of any GameObject. Through the use of the additional button you can switch this on and off to see more clearly how the objects intersect with each other.</p>
<div><div id="highlighter_104060" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">01</div><div class="line number2 index1 alt1">02</div><div class="line number3 index2 alt2">03</div><div class="line number4 index3 alt1">04</div><div class="line number5 index4 alt2">05</div><div class="line number6 index5 alt1">06</div><div class="line number7 index6 alt2">07</div><div class="line number8 index7 alt1">08</div><div class="line number9 index8 alt2">09</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">function showObjectBounds(gameObject, transitionX, transitionY)</code></div><div class="line number2 index1 alt1"><code class="plain plain">{</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(showBounds)</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(typeof(transitionX) != 'undefined')</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">rectX = transitionX;</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">rectX = gameObject.x;</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(typeof(transitionY) != 'undefined')</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">rectY = transitionY;</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">rectY = gameObject.y;</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.save();</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.strokeStyle = '#f00'; // red</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.lineWidth&nbsp;&nbsp; = 2;</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.strokeRect(rectX, rectY, gameObject.image.width, gameObject.image.height);</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.restore();</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number23 index22 alt2"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Notice the additional parameters for a transition value of x and y. This is useful when objects are being transitioned (i.e. in our case rotated) and the true value of x and y, as a consequence of the translate function being applied to the context, is no longer the x and y values of the supplied object. </p>
<h4>Creating the Prizes</h4>
<p>The prizes consist of 3 (4 on later levels) rows of 23 prizes which fit just right into the available screen space at the top. Each prize is 20 x 20 which means a total width of 460 (i.e. 23 x 20) leaving 10 pixel border at each end. To create the prizes I simply created an object of type Prize for each one and added it to an array. Then set the image depending on the row meaning we had a row of leaves, acorns and flowers respectively. Notice also that we set the x,y co-ordinates of each prize based on it’s col and row position multiplied by a suitable offset.</p>
<div><div id="highlighter_876698" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">01</div><div class="line number2 index1 alt1">02</div><div class="line number3 index2 alt2">03</div><div class="line number4 index3 alt1">04</div><div class="line number5 index4 alt2">05</div><div class="line number6 index5 alt1">06</div><div class="line number7 index6 alt2">07</div><div class="line number8 index7 alt1">08</div><div class="line number9 index8 alt2">09</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">function initPrizes()</code></div><div class="line number2 index1 alt1"><code class="plain plain">{</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">var count=0;</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">for(var x=0; x&lt;3; x++)</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">for(var y=0; y&lt;23; y++)</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">prize = new Prize();</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(x==0)</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">prize.image = flowerImg;</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(x==1)</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">prize.image = acornImg;</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(x==2)</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">prize.image = leafImg;</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">prize.row = x;</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">prize.col = y;</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">prize.x = 20 * prize.col + 10;</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">prize.y = 30 * prize.row + 20;</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">prizes[count] = prize;</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">count++;</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number24 index23 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<h4>Drawing the Prizes</h4>
<p>For each game loop we re-draw the prizes but only those that have not already been hidden. When the animal initially hits the prize (as determined by  checkIntersect ) the prize completes a full rotation. Not until it reaches a full 360 degrees do I mark it as hit and subsequently cause it to disappear.</p>
<div><div id="highlighter_549039" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">01</div><div class="line number2 index1 alt1">02</div><div class="line number3 index2 alt2">03</div><div class="line number4 index3 alt1">04</div><div class="line number5 index4 alt2">05</div><div class="line number6 index5 alt1">06</div><div class="line number7 index6 alt2">07</div><div class="line number8 index7 alt1">08</div><div class="line number9 index8 alt2">09</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">function drawPrizes()</code></div><div class="line number2 index1 alt1"><code class="plain plain">{</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">for(var x=0; x&lt;prizes.length; x++)</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">currentPrize = prizes[x];</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(!currentPrize.hit)</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(currentPrize.spinning)</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">currentPrize.angle += 10;</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.save();</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Translate to the center of the prize (i.e. the point about which we are going to perform the rotation</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.translate(currentPrize.x + (currentPrize.image.width/2), currentPrize.y + (currentPrize.image.height/2));</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Perform the rotation based on the current prize angle</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.rotate(currentPrize.angle * Math.PI/180);</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.drawImage(currentPrize.image, - (currentPrize.image.width/2), - (currentPrize.image.width/2));</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">showObjectBounds(currentPrize, - (currentPrize.image.width/2), - (currentPrize.image.width/2));</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.restore();</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(currentPrize.angle == 360)</code></div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">currentPrize.hit = true;</code></div><div class="line number28 index27 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number29 index28 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else</code></div><div class="line number30 index29 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number31 index30 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.drawImage(currentPrize.image, prizes[x].x, prizes[x].y);</code></div><div class="line number32 index31 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">showObjectBounds(currentPrize);</code></div><div class="line number33 index32 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number34 index33 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number35 index34 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number36 index35 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<h4>Drawing the Mushroom</h4>
<p>I draw the mushroom on the canvas but depending on whether it’s boinging or not I alternate the image between its normal image and the squashed image. By toggling the wobble property of the mushroom object I count each change up to 50 and then set boinging to false to show it in its normal sate.</p>
<div><div id="highlighter_454827" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">01</div><div class="line number2 index1 alt1">02</div><div class="line number3 index2 alt2">03</div><div class="line number4 index3 alt1">04</div><div class="line number5 index4 alt2">05</div><div class="line number6 index5 alt1">06</div><div class="line number7 index6 alt2">07</div><div class="line number8 index7 alt1">08</div><div class="line number9 index8 alt2">09</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">//Draw the mushroom (depending on its current status)</code></div><div class="line number2 index1 alt1"><code class="plain plain">function drawMushroom()</code></div><div class="line number3 index2 alt2"><code class="plain plain">{</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">showObjectBounds(mushroom);</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(!mushroom.boing)</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.drawImage(mushroom.image, mushroom.x, mushroom.y);</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//toggle the wobble!</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">mushroom.wobble = !mushroom.wobble;</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//increment wobble count</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">mushroom.wobbleCount++;</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(mushroom.wobbleCount &gt; 50)</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">mushroom.boing = false;</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">mushroom.wobbleCount = 0;</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">mushroom.wobble = false;</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Mushroom has just been hit so make it wobble!</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(mushroom.wobble)</code></div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.drawImage(mushroom.squashedImg, mushroom.x, mushroom.y);</code></div><div class="line number28 index27 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else</code></div><div class="line number29 index28 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.drawImage(mushroom.image, mushroom.x, mushroom.y);</code></div><div class="line number30 index29 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number31 index30 alt2"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<h4>Drawing the Animal</h4>
<p>Like the prizes, the animal spins based on certain criteria. Unlike the prize, the animal is always spinning, but not necessarily in the same direction. As mentioned in my previous post in order to rotate an image you need to do a few things in HTML5 to ensure success.</p>
<p>1. Save the current state of the canvas to ensure we can return to that state after we’ve finished the translation.<br>
2. Adjust the angle of the animal based on its horizontal speed. i.e. if currently tracking to the right rotate the animal clockwise, if tracking to the left rotate the animal counter-clockwise.<br>
3. Translate to the centre of the animal using the translate method of the canvas 2d context.<br>
4. Perform the rotation<br>
5. Draw the animal but now using the translated co-ordinates (but moving back out to the top left side of the animals rectangular bounds so we deduct half the hight and width from the x and y co-ordinates accordingly).<br>
6. Restore the context state.</p>
<p>This can now be seen in the method drawAnimal below</p>
<div><div id="highlighter_503178" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">01</div><div class="line number2 index1 alt1">02</div><div class="line number3 index2 alt2">03</div><div class="line number4 index3 alt1">04</div><div class="line number5 index4 alt2">05</div><div class="line number6 index5 alt1">06</div><div class="line number7 index6 alt2">07</div><div class="line number8 index7 alt1">08</div><div class="line number9 index8 alt2">09</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">function drawAnimal()</code></div><div class="line number2 index1 alt1"><code class="plain plain">{</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.save();</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Translate to the center of the bear (i.e. the point about which we are going to perform the rotation</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.translate(animal.x + (animal.image.width/2), animal.y + (animal.image.height/2));</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Adjust the angle according to the horizontal speed</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">animal.angle += horizontalSpeed;</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(animal.angle &lt; 0) animal.angle=360;</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else if(animal.angle&gt;360) animal.angle=0;</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Perform the rotation based on the current bear angle</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.rotate(animal.angle * Math.PI/180);</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Draw the bear (if he's going down open eyes!)</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Also note that the X,Y coordinates are based on the moving out from the center of the bear and not the original bearX and bearY</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//This is because of the translate function we performed earlier</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">showObjectBounds(animal, - (animal.image.width/2), - (animal.image.width/2));</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(verticalSpeed&gt;0)</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.drawImage(animal.eyesOpenImg, - (animal.eyesOpenImg.width/2), - (animal.eyesOpenImg.width/2));</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else</code></div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.drawImage(animal.image, - (animal.image.width/2), - (animal.image.width/2));</code></div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.restore();</code></div><div class="line number30 index29 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<h4>Checking the animal has hit the edge of the screen</h4>
<p>If the animal hits any edge of the screen we need to take some action. In the case of the left, top and right edges we simply reverse the animal’s horizontal or vertical speed accordingly. In the case of the bottom edge we must stop the game loop and signify to the user that the animal has hit the ground (in short you’ve lost a life). Now, using our GameObject we can easily check the objects x and y co-ordinates and take the appropriate action as shown below.</p>
<div><div id="highlighter_89825" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">01</div><div class="line number2 index1 alt1">02</div><div class="line number3 index2 alt2">03</div><div class="line number4 index3 alt1">04</div><div class="line number5 index4 alt2">05</div><div class="line number6 index5 alt1">06</div><div class="line number7 index6 alt2">07</div><div class="line number8 index7 alt1">08</div><div class="line number9 index8 alt2">09</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">function hasAnimalHitEdge()</code></div><div class="line number2 index1 alt1"><code class="plain plain">{</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Has the bear reached the far right hand side?</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(animal.x&gt;screenWidth - animal.image.width)</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//bouncing off the right hand side so play boing and reverse horizontal speed</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">boing2.play();</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">horizontalSpeed =-speed;</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Has bear reached the far left hand side?</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(animal.x&lt;0)</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//bouncing off the left hand side so play boing and reverse horizontal speed</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">boing3.play();</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">horizontalSpeed = speed;</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Has bear hit the bottom of the screen - Ouch!</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(animal.y&gt;screenHeight - animal.image.height)</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Bouncing off bottom, so play boing and reverse vertical speed</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">awwwww.play();</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">verticalSpeed = -speed;</code></div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Stop game for now</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">toggleGameplay();</code></div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Has bear hit to the top of the screen</code></div><div class="line number30 index29 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(animal.y&lt;0)</code></div><div class="line number31 index30 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number32 index31 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Bouncing off top, so play boing and reverse vertical speed</code></div><div class="line number33 index32 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">boing4.play();</code></div><div class="line number34 index33 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">verticalSpeed = speed;</code></div><div class="line number35 index34 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number36 index35 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<h4>Boing!</h4>
<p>Checking that the animal has hit the mushroom is now very easy thanks to our checkIntersect method I already created. However, as mentioned on a previous post, depending where on the mushroom the animal landed we need to send him in the appropriate direction. i.e. very left, left, right or very right. Those of you who think this is just like a block breaker game but with animals and food, pat yourselves on the back – you’re right <img src="./HTML5 Writing a game  Step 4 » Jacebook_files/icon_smile.gif" alt=":-)" class="wp-smiley"> </p>
<div><div id="highlighter_589240" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">01</div><div class="line number2 index1 alt1">02</div><div class="line number3 index2 alt2">03</div><div class="line number4 index3 alt1">04</div><div class="line number5 index4 alt2">05</div><div class="line number6 index5 alt1">06</div><div class="line number7 index6 alt2">07</div><div class="line number8 index7 alt1">08</div><div class="line number9 index8 alt2">09</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">function hasAnimalHitMushroom()</code></div><div class="line number2 index1 alt1"><code class="plain plain">{</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Has bear hit mushroom</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(checkIntersect(animal, mushroom, 5))</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if((animal.x + animal.image.width/2) &lt; (mushroom.x + mushroom.image.width*0.25))</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">horizontalSpeed = -speed;</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else if((animal.x + animal.image.width/2) &lt; (mushroom.x + mushroom.image.width*0.5))</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">horizontalSpeed = -speed/2;</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else if((animal.x + animal.image.width/2) &lt; (mushroom.x + mushroom.image.width*0.75))</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">horizontalSpeed = speed/2;</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">horizontalSpeed = speed;</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">boing1.play();</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">mushroom.boing = true;</code></div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">verticalSpeed = -speed;</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number28 index27 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<h4>Have we won!</h4>
<p>Next we need to check if the animal has in fact hit a prize. Again this is very easy thanks to the checkIntersect function created ealier. However, instead of immediately setting the Prize hit value to true, we first set spinning to true to kick off the spinning motion.</p>
<div><div id="highlighter_420175" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">01</div><div class="line number2 index1 alt1">02</div><div class="line number3 index2 alt2">03</div><div class="line number4 index3 alt1">04</div><div class="line number5 index4 alt2">05</div><div class="line number6 index5 alt1">06</div><div class="line number7 index6 alt2">07</div><div class="line number8 index7 alt1">08</div><div class="line number9 index8 alt2">09</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">*function hasAnimalHitPrize()</code></div><div class="line number2 index1 alt1"><code class="plain plain">{</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">for(var x=0; x&lt;prizes.length; x++)</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">var prize = prizes[x];</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(!prize.hit)</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(checkIntersect(prize, animal, 0))</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//alert("hit prize");</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//prize.hit = true;</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">prize.spinning = true;</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">verticalSpeed = speed;</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Play sound based on hight of prize</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(prize.row == 0)</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">collisionStartPrize.play();</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">else</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">collisionPrize.play()</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">}</code></div><div class="line number23 index22 alt2"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<h4>Deja vu all over again</h4>
<p>Thanks to the use of javascript objects to represent each game object and farming all the functionality of the game out to separate atomic functions, the game loop has become much simpler and consequently much easier to read. Meaning we just:-</p>
<p>1. clear the screen.<br>
2. move the animals x and y position.<br>
3. draw the background.<br>
4. draw the prizes.<br>
5. draw the mushroom.<br>
6. draw the animal.<br>
7. check if the animal has hit the edge.<br>
8. check if the animal has hit the mushroom.<br>
9. check if the animal has hit the prize.</p>
<div><div id="highlighter_449814" class="syntaxhighlighter  plain"><div class="toolbar"><span><a href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">01</div><div class="line number2 index1 alt1">02</div><div class="line number3 index2 alt2">03</div><div class="line number4 index3 alt1">04</div><div class="line number5 index4 alt2">05</div><div class="line number6 index5 alt1">06</div><div class="line number7 index6 alt2">07</div><div class="line number8 index7 alt1">08</div><div class="line number9 index8 alt2">09</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">//Main game loop, it all happens here!</code></div><div class="line number2 index1 alt1"><code class="plain plain">function gameLoop(){&nbsp; </code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Clear the screen (i.e. a draw a clear rectangle the size of the screen)</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.clearRect(0, 0, screenWidth, screenHeight);</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Move the bear in the current direction</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">animal.x += horizontalSpeed;</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">animal.y += verticalSpeed;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Draw the background forest</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">ctx.drawImage(backgroundForestImg, 0, 0);</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Draw prizes</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">drawPrizes()</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Draw the mushroom (depending on its current status)</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">drawMushroom();</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//draw animal</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">drawAnimal();</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">//Check collisions for animal</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">hasAnimalHitEdge();</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">hasAnimalHitMushroom();</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">hasAnimalHitPrize();</code></div><div class="line number29 index28 alt2"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>So that’s step 4, which to be honest supersedes all the previous steps thanks to the rewrite. But hey this is a real live research project and by now I’m beginning to think we have the makings of a real game in HTML5. Hopefully you agree!</p>
<p>Next I’ll be focusing on keeping score and putting some baddies in the game….. exciting stuff!</p>
<p>Thanks for visiting my blog the game so far is <a href="http://jacebook.co.uk/share/html5/">here</a>.</p>
				</div>
												<div class="article-meta-keywords">Tags: <a href="http://jacebook.co.uk/blog/tag/bouncing-animals/" rel="tag">bouncing animals</a>, <a href="http://jacebook.co.uk/blog/tag/game/" rel="tag">game</a>, <a href="http://jacebook.co.uk/blog/tag/html5/" rel="tag">html5</a>, <a href="http://jacebook.co.uk/blog/tag/iphone/" rel="tag">iPhone</a></div>
			</div>
			<div class="article-footer"></div>
		</div>
		
			<div id="comments">




								<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://jacebook.co.uk/blog/2010/09/15/html5-writing-a-game-step-4/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://jacebook.co.uk/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">Your email is <em>never</em> published nor shared.</p>							<div class="comment-form-author"><input id="author" name="author" type="text" value="" size="30" class="text"><label for="author">Name <span class="required">(Required)</span></label> </div><!-- #form-section-author .form-section -->
<div class="comment-form-email"><input id="email" name="email" type="text" value="" size="30" class="text"><label for="email">Email <span class="required">(Required)</span></label> </div><!-- #form-section-email .form-section -->
<div class="comment-form-url"><input id="url" name="url" type="text" value="" size="30" class="text"><label for="url">Website</label></div><!-- #form-section-url .form-section -->
												<div class="comment-form-comment"><textarea id="comment" name="comment" cols="45" rows="8"></textarea></div><!-- #form-section-comment .form-section -->						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:<code>&lt;a href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; &lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="Post Comment" class="input-submit">
							<input type="hidden" name="comment_post_ID" value="202" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
						</p>
											</form>
							</div><!-- #respond -->
						
</div><!-- #comments -->


	</div><!-- contents-->
	<div id="sidebar">
		<ul class="sidebar">
<li id="categories-5" class="widget widget_categories"><div class="side-contents"><h2 class="side-title-first">Categories</h2>		<ul>
	<li class="cat-item cat-item-21"><a href="http://jacebook.co.uk/blog/category/diaspora/" title="View all posts filed under Diaspora">Diaspora</a>
</li>
	<li class="cat-item cat-item-6"><a href="http://jacebook.co.uk/blog/category/adobe/flash-builder/" title="View all posts filed under Flash Builder">Flash Builder</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://jacebook.co.uk/blog/category/fun/" title="Not so serious blogs!">Fun</a>
</li>
	<li class="cat-item cat-item-26"><a href="http://jacebook.co.uk/blog/category/html5/" title="View all posts filed under html5">html5</a>
</li>
	<li class="cat-item cat-item-11"><a href="http://jacebook.co.uk/blog/category/java-script/" title="All thing java script">Java Script</a>
</li>
	<li class="cat-item cat-item-12"><a href="http://jacebook.co.uk/blog/category/java-script/jquery/" title="View all posts filed under jQuery">jQuery</a>
</li>
		</ul>
</div></li><li id="linkcat-2" class="widget widget_links"><div class="side-contents"><h2 class="side-title">Blogroll</h2>
	<ul class="xoxo blogroll">
<li><a href="http://jqueryfordesigners.com/" title="A great site for designers interesting in using jQuery to spice up their vision">jQuery For Designers</a></li>
<li><a href="http://processingjs.org/" title="Promising animation JS wrapper to the HTML5 canvas element">Processing JS</a></li>

	</ul>
</div></li>
<li id="tag_cloud-3" class="widget widget_tag_cloud"><div class="side-contents"><h2 class="side-title">Tags</h2><div class="tagcloud"><a href="http://jacebook.co.uk/blog/tag/attribute/" class="tag-link-19" title="1 topic" style="font-size: 8pt;">Attribute</a>
<a href="http://jacebook.co.uk/blog/tag/bouncing-animals/" class="tag-link-28" title="6 topics" style="font-size: 22pt;">bouncing animals</a>
<a href="http://jacebook.co.uk/blog/tag/cash-point/" class="tag-link-14" title="1 topic" style="font-size: 8pt;">cash point</a>
<a href="http://jacebook.co.uk/blog/tag/diaspora/" class="tag-link-21" title="1 topic" style="font-size: 8pt;">Diaspora</a>
<a href="http://jacebook.co.uk/blog/tag/distributed/" class="tag-link-23" title="1 topic" style="font-size: 8pt;">Distributed</a>
<a href="http://jacebook.co.uk/blog/tag/facebook/" class="tag-link-22" title="1 topic" style="font-size: 8pt;">Facebook</a>
<a href="http://jacebook.co.uk/blog/tag/flash-builder-2/" class="tag-link-8" title="1 topic" style="font-size: 8pt;">flash builder</a>
<a href="http://jacebook.co.uk/blog/tag/flash-catalyst/" class="tag-link-9" title="1 topic" style="font-size: 8pt;">flash catalyst</a>
<a href="http://jacebook.co.uk/blog/tag/game/" class="tag-link-30" title="6 topics" style="font-size: 22pt;">game</a>
<a href="http://jacebook.co.uk/blog/tag/html5/" class="tag-link-26" title="6 topics" style="font-size: 22pt;">html5</a>
<a href="http://jacebook.co.uk/blog/tag/iphone/" class="tag-link-29" title="6 topics" style="font-size: 22pt;">iPhone</a>
<a href="http://jacebook.co.uk/blog/tag/jquery/" class="tag-link-12" title="1 topic" style="font-size: 8pt;">jQuery</a>
<a href="http://jacebook.co.uk/blog/tag/not/" class="tag-link-20" title="1 topic" style="font-size: 8pt;">Not</a>
<a href="http://jacebook.co.uk/blog/tag/selectors/" class="tag-link-18" title="1 topic" style="font-size: 8pt;">Selectors</a>
<a href="http://jacebook.co.uk/blog/tag/short/" class="tag-link-13" title="1 topic" style="font-size: 8pt;">short</a>
<a href="http://jacebook.co.uk/blog/tag/social-network/" class="tag-link-24" title="1 topic" style="font-size: 8pt;">Social Network</a>
<a href="http://jacebook.co.uk/blog/tag/tipping-point/" class="tag-link-25" title="1 topic" style="font-size: 8pt;">Tipping Point</a>
<a href="http://jacebook.co.uk/blog/tag/transitions/" class="tag-link-10" title="1 topic" style="font-size: 8pt;">transitions</a>
<a href="http://jacebook.co.uk/blog/tag/twitter/" class="tag-link-17" title="1 topic" style="font-size: 8pt;">twitter</a>
<a href="http://jacebook.co.uk/blog/tag/verified/" class="tag-link-16" title="1 topic" style="font-size: 8pt;">verified</a>
<a href="http://jacebook.co.uk/blog/tag/whitchurch/" class="tag-link-15" title="1 topic" style="font-size: 8pt;">Whitchurch</a></div>
</div></li><li id="twitter-1" class="widget widget_twitter"><div class="side-contents"><h2 class="side-title"><a href="http://twitter.com/jason_croucher" class="twitter_title_link">Tweets</a></h2><ul class="twitter"><li class="twitter-item"> <a href="http://twitter.com/wossy" class="twitter-user">@wossy</a> clarkson, brand and evans preferably on the same night! But doubt you'll manage it... Good luck with the show though  <span class="twitter-timestamp"><abbr title="2011/09/04 19:41:00">2011/09/04</abbr></span></li><li class="twitter-item"> Apple TV round the corner? <a href="http://t.co/FF1a6Sq" class="twitter-link">http://t.co/FF1a6Sq</a>  <span class="twitter-timestamp"><abbr title="2011/08/29 06:58:18">2011/08/29</abbr></span></li><li class="twitter-item"> Something web devs have know for sometime ;-) <a href="http://is.gd/nQ4NCW" class="twitter-link">http://is.gd/nQ4NCW</a>  <span class="twitter-timestamp"><abbr title="2011/07/31 18:03:15">2011/07/31</abbr></span></li><li class="twitter-item"> <a href="http://twitter.com/shabba1973" class="twitter-user">@shabba1973</a> good news - you'll rust with that much iron in ya. Hope you're feeling better!  <span class="twitter-timestamp"><abbr title="2011/07/25 18:47:12">2011/07/25</abbr></span></li><li class="twitter-item"> <a href="http://twitter.com/p4as" class="twitter-user">@p4as</a> Shame - hope to see you on g+ dude  <span class="twitter-timestamp"><abbr title="2011/07/21 20:05:32">2011/07/21</abbr></span></li></ul></div></li>		</ul>
		<div class="end-sidebar"></div>
	</div>	<div id="footer">
		<div>© Jacebook 2011 - Powered by WordPress - Theme RedBel by Belouga.</div>
		<div><a href="http://jacebook.co.uk/?feed=rss2">Entries (RSS)</a> and <a href="http://jacebook.co.uk/?feed=comments-rss2">Comments (RSS)</a>.</div>
	</div>
</div>
<script type="text/javascript"> 
/* <![CDATA[ */
$("#header .menu li").hover(function(){$(this).find('ul:first').css({visibility: "visible",display: "none"}).slideToggle(268);},function(){ $(this).find('ul:first').slideToggle(268);});
$('#header li:not(#header .menu li li):not(.current_page_item):not(.current_page_parent):not(.current_page_ancestor)')
	.css( {backgroundPosition: "0 38px"} )
	.mouseover(function(){$(this).stop().animate({backgroundPosition:"(0 0)"}, 200);})
	.mouseout(function(){$(this).stop().animate({backgroundPosition:"(0 38px)"}, 200);})
$('.top-link')
	.css( {backgroundPosition: "right top"} )
	.mouseover(function(){$(this).stop().animate({backgroundPosition:"(right -3px)"}, 200);})
	.mouseout(function(){$(this).stop().animate({backgroundPosition:"(right top)"}, 200);})
if($.browser.safari || $.browser.Chrome){ bodyelem = $("body") } else{ bodyelem = $("html") }
$('a').click(function(){if($(this).attr("href").charAt(0) == "#"){bodyelem.animate({scrollTop: $($(this).attr("href")).offset().top+'px'}, 500);return false;}else{return true;}});
$('.search-label-sliding').css({ left: "15px" })
$('.search-label-sliding').animate({ opacity: "0.4" }).click(function() {var thisFor = $(this).attr('for');	$('.'+thisFor).focus();});
$('.search-sliding').focus(function() {$('.search-label-sliding').animate({ left: "160px" }, "fast");
	if($(this).val() == "Search") $(this).val() == "";
}).blur(function() {if($(this).val() == "") {$(this).val() == "Search";$('.search-label-sliding').animate({ left: "15px" }, "fast");}});
$('input:submit').addClass('input-submit');
$('input:button').addClass('input-submit');
$('input:reset').addClass('input-submit');
/* ]]> */
</script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./HTML5 Writing a game  Step 4 » Jacebook_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-18293830-1");
pageTracker._trackPageview();
} catch(err) {}</script>
<script type="text/javascript" src="./HTML5 Writing a game  Step 4 » Jacebook_files/shCore.js"></script>
<script type="text/javascript" src="./HTML5 Writing a game  Step 4 » Jacebook_files/shBrushPlain.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://jacebook.co.uk/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83c";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://jacebook.co.uk/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.83c";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = true;
	SyntaxHighlighter.defaults['wrap-lines'] = false;
	SyntaxHighlighter.all();
</script>

</body></html>